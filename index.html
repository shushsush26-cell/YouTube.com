document.getElementById('messageForm').addEventListener('submit', async function(event) {
    event.preventDefault();

    const form = event.target;
    const formData = new FormData(form);
    const message = formData.get('message');
    const statusDiv = document.getElementById('status');
    const submitBtn = document.getElementById('submitBtn');

    statusDiv.style.display = 'block';
    statusDiv.className = 'loading';
    statusDiv.textContent = '‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è...';
    submitBtn.disabled = true;

    try {
        console.log('–ù–∞—á–∏–Ω–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É...');
        
        const response = await fetch('https://api.telegram.org/bot8591266062:AAEwMbSDWQXYmZ6W9CekGxlnJUqRQIB0v8M/sendMessage', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                chat_id: '6812452143',
                text: `üì® –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Å–∞–π—Ç–∞:\n\n${message}`
            })
        });

        console.log('–û—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω:', response);

        const result = await response.json();
        console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç:', result);

        if (result.ok) {
            statusDiv.textContent = '‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram!';
            statusDiv.className = 'success';
            form.reset();
        } else {
            statusDiv.textContent = '‚ùå –û—à–∏–±–∫–∞ Telegram: ' + (result.description || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞');
            statusDiv.className = 'error';
        }

    } catch (error) {
        console.error('–ü–æ–ª–Ω–∞—è –æ—à–∏–±–∫–∞:', error);
        statusDiv.textContent = '‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message;
        statusDiv.className = 'error';
    }

    statusDiv.style.display = 'block';
    submitBtn.disabled = false;
});
